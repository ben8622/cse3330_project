<body>
  <h1  class="text-center">Assignment</h1>

  <div>
    <h2>Requirement 1, Create New Customer</h2>
    <hr/>
    <form id="newCustForm">

      <div>
        <label>Name:</label>
        <input type="text" name="name"/>
      </div>
      <div>
        <label >Phone:</label>
        <input type="text" name="phone"/>
      </div>

    </form>
    <button id="createCustBtn">Submit Button</button>
  </div>

  <div>
    <h2>Requirement 2, Create New Vehicles</h2>
    <hr/>
    <form id="newVehicleForm">

      <div>
        <label>Vehicle Id:</label>
        <input type="text" name="vehicleId"/>
      </div>
      <div>
        <label >Description:</label>
        <input type="text" name="description"/>
      </div>
      <div>
        <label >Year:</label>
        <input type="text" name="year"/>
      </div>
      <div>
        <label >Type:</label>
        <select name="type">
          <option value="1">Compact</option>
          <option value="2">Medium</option>
          <option value="3">Large</option>
          <option value="4">SUV</option>
          <option value="5">Truck</option>
          <option value="6">Van</option>
        </select>
      </div>
      <div>
        <label >Category:</label>
        <select name="category">
          <option value="1">Basic</option>
          <option value="2">Luxury</option>
        </select>
      </div>

    </form>
    <button id="createVehicleBtn">Submit Button</button>
  </div>

  <div>
    <h2>Requirement 3, Create New Rental</h2>
    <hr/>
    <form id="newRentalForm">

        <select id="rentalVehicleId" class="form-control">
          <option value="-1">Select a vehicle</option>
        </select>

    </form>
    <button id="createRentalBtn">Submit Button</button>
  </div>

  <div class="text-center">
    <button id="example_query_1">Example Query 1</button>
    <button id="example_query_2">Example Query 2</button>
    <button id="example_query_3">Example Query 3</button>
  </div>
  <div>
    <table class="table table-bordered table-hover table-responsive-sm">
      <thead id="query_table_header"></thead>
      <tbody id="query_table_body"></tbody>
    </table>
  </div>
</body>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script type=text/javascript>
  $(function() {

    // REQUIREMENT 1
    $("#createCustBtn").on("click", function(e){
      e.preventDefault();
      $.ajax({
        url: "{{url_for('assignment.requirement1')}}",
        type: "POST",
        dataType: 'json',
        data: $("#newCustForm").serialize(),
        success: function(response){
          alert("Created customer!")
        },
        error: function(jqXHR, status, error){
          alert(error)
        }
      });
    })

    // REQUIREMENT 2
    $("#createVehicleBtn").on("click", function(e){
      e.preventDefault();
      $.ajax({
        url: "{{url_for('assignment.requirement2')}}",
        type: "POST",
        dataType: 'json',
        data: $("#newVehicleForm").serialize(),
        success: function(response){
          alert("Created vehicle!")
        },
        error: function(jqXHR, status, error){
          alert(error)
        }
      });
    })

    $("#rentalVehicleId").select2({
      placeholder: 'Select a vehicle',
      ajax: {
        url: "{{url_for('assignment.available_vehicles')}}",
        dataType: "json",
        processResults: function(data){
          debugger;
          return {
            results: data.map(x => {
              return {
                'text': x[1],
                'value': x[0]
              }
            })
          }
        }
      }
    });

    $("#example_query_1").on("click", function(e){
      e.preventDefault();
      $.ajax({
        url: "{{url_for('assignment.example_query_1')}}",
        dataType: 'json',
        success: function(response){
          var cols = ["VIN", "Description", "Year", "Type", "Category"]
          createTable(response, cols)
        },
        error: function(jqXHR, status, error){
          alert(error)
        }
      });
    });

    $("#example_query_2").on("click", function(e){
      e.preventDefault();
      $.ajax({
        url: "{{url_for('assignment.example_query_2')}}",
        dataType: 'json',
        success: function(response){
          var cols = ["CustID", "Name", "Phone"]
          createTable(response, cols)
        },
        error: function(jqXHR, status, error){
          alert(error)
        }
      });
    });

    $("#example_query_3").on("click", function(e){
      e.preventDefault();
      $.ajax({
        url: "{{url_for('assignment.example_query_3')}}",
        dataType: 'json',
        success: function(response){
          var cols = ["Rentals Count"]
          createTable(response, cols);
        },
        error: function(jqXHR, status, error){
          alert(error);
        }
      })
    })

    function createTable(rows, cols){
      // Empty table data
      $("#query_table_body").html("")

      // Create the Table Headers for the query
      var trHeader = $("<tr>");
      cols.forEach(col => {
        var th = $("<th>");
        th.text(col);
        trHeader.append(th);
      });
      $("#query_table_header").html(trHeader)

      // Create the rows in table
      rows.forEach(entity => {
        var tr = $("<tr>")
        entity.forEach(attr => {
          var td = $("<td>");
          td.text(attr);
          tr.append(td);
        })
        var temp = tr.html()
        $("#query_table_body").append(tr)
      })
    }

  });
</script>

<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
<style>
  /* body{
    background-color: #404040;
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 5px;
  }
  button{
    background-color: #eb7900;
    border-radius: 10px; 
  } */
</style>